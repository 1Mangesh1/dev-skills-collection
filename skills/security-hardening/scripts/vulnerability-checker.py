#!/usr/bin/env python3
"""Security Vulnerability Checker"""

import json

def check_input_validation(code_snippet):
    """Check if input is properly validated"""
    
    issues = []
    
    # Check for SQL injection patterns
    if "$" in code_snippet and "SELECT" in code_snippet:
        issues.append({
            "type": "SQL_INJECTION_RISK",
            "severity": "CRITICAL",
            "pattern": "String interpolation in SQL query",
            "fix": "Use parameterized queries"
        })
    
    # Check for hardcoded secrets
    if "password" in code_snippet.lower() and "=" in code_snippet:
        issues.append({
            "type": "HARDCODED_SECRET",
            "severity": "CRITICAL",
            "pattern": "Hardcoded password detected",
            "fix": "Use environment variables"
        })
    
    # Check for missing HTTPS
    if "http://" in code_snippet and "external" in code_snippet.lower():
        issues.append({
            "type": "INSECURE_PROTOCOL",
            "severity": "HIGH",
            "pattern": "HTTP used for sensitive data",
            "fix": "Use HTTPS"
        })
    
    return {
        "code_length": len(code_snippet),
        "issues_found": len(issues),
        "vulnerabilities": issues,
        "security_score": 100 - (len(issues) * 10)
    }

if __name__ == "__main__":
    test_code = """
    password = "secretpassword123"
    query = f"SELECT * FROM users WHERE id = {user_id}"
    response = requests.get(f"http://api.example.com/data")
    """
    
    result = check_input_validation(test_code)
    print(json.dumps(result, indent=2))
